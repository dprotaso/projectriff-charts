#@ load("@ytt:overlay", "overlay")
#@ load("@ytt:data", "data")

#! Remove duplicate Knative CRDs

#@ def conditional_match(condition, match_func):
#@   def wrapped_match_func(a,b,c):
#@     if condition != True:
#@       return False
#@     end
#@     return match_func(a,b,c)
#@   end
#@   return wrapped_match_func
#@ end

#@overlay/match by=conditional_match(data.values.dropKnativeImageCRD, overlay.subset({ "apiVersion": "apiextensions.k8s.io/v1beta1", "kind": "CustomResourceDefinition", "metadata": { "name": "images.caching.internal.knative.dev" } })), expects="0+"
#@overlay/remove
---
